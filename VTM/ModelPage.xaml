<Page
    x:Class="VTM.ModelPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:System="clr-namespace:System;assembly=mscorlib"
    xmlns:core="clr-namespace:HVT.VTM.Base;assembly=HVT.VTM.Base"
    xmlns:ctr="clr-namespace:HVT.Controls;assembly=HVT.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:fa="http://schemas.awesome.incremented/wpf/xaml/fontawesome.sharp"
    xmlns:local="clr-namespace:VTM"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="ModelPage"
    d:DesignHeight="1000"
    d:DesignWidth="1600"
    Loaded="ModelPage_Loaded"
    mc:Ignorable="d">
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/CSS/FlatStyle.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <ObjectDataProvider
                x:Key="rxDataKindEnum"
                MethodName="GetValues"
                ObjectType="{x:Type System:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="core:RxDataKind" />
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>

            <ObjectDataProvider
                x:Key="rxDataTypeEnum"
                MethodName="GetValues"
                ObjectType="{x:Type System:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="core:RxDataType" />
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
        </ResourceDictionary>
    </Page.Resources>
    <Grid PreviewKeyDown="Grid_PreviewKeyDown">
        <TabControl
            Margin="5,15,5,5"
            VerticalContentAlignment="Center"
            Background="#f6f6f6"
            BorderThickness="0">
            <!--  Tap steps  -->
            <TabItem
                BorderThickness="0"
                Foreground="Black"
                Header="Steps"
                Style="{StaticResource FlatTabControl}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="50" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="0.3*" />
                    </Grid.RowDefinitions>

                    <DataGrid
                        x:Name="StepsGridData"
                        Margin="5,5,0,5"
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        CanUserDeleteRows="True"
                        ClipboardCopyMode="IncludeHeader"
                        ColumnHeaderStyle="{StaticResource FlatDataGridHeaderNomal}"
                        CurrentCellChanged="StepsGridData_CurrentCellChanged"
                        EnableColumnVirtualization="True"
                        EnableRowVirtualization="True"
                        GridLinesVisibility="All"
                        HeadersVisibility="Column"
                        IsReadOnly="False"
                        ItemsSource="{Binding Steps}"
                        MouseDoubleClick="DataGridCell_MouseDoubleClick"
                        MouseDown="StepsGridData_MouseDown"
                        PreviewKeyDown="StepsGridData_PreviewKeyDown"
                        RowHeight="18"
                        SelectedCellsChanged="StepsGridData_SelectedCellsChanged"
                        SelectionMode="Single"
                        SelectionUnit="Cell"
                        Style="{StaticResource FlatDataGrid}">
                        <DataGrid.Columns>
                            <DataGridTextColumn
                                Width="60"
                                Binding="{Binding No}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="No"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                Width="70"
                                Binding="{Binding IMQSCode, UpdateSourceTrigger=PropertyChanged}"
                                CellStyle="{StaticResource FlatVTMCellConstance}"
                                Header="QR Code"
                                IsReadOnly="True" />

                            <DataGridComboBoxColumn
                                Width="200"
                                CanUserSort="False"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Content">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="{x:Type ComboBox}">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Background="#01000000" Text="{Binding TestContent, UpdateSourceTrigger=PropertyChanged}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="Foreground" Value="WhiteSmoke" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.TestContentsList}" />
                                        <Setter Property="SelectedItem" Value="{Binding TestContent}" />
                                        <Setter Property="Text" Value="{Binding TestContent}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding CommandDescriptions.TestContentsList}" Value="{x:Null}">
                                                <Setter Property="SelectedItem" Value="{x:Null}" />
                                                <Setter Property="IsDropDownOpen" Value="False" />
                                                <Setter Property="ItemsSource" Value="{x:Null}" />
                                                <Setter Property="MaxDropDownHeight" Value="0" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="60"
                                CellStyle="{StaticResource FlatVTMCellCMD}"
                                ClipboardContentBinding="{Binding CMD}"
                                Header="CMD">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding CMD}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="False" />
                                        <EventSetter Event="SelectionChanged" Handler="CmdSelectionChanged" />
                                        <Setter Property="Text" Value="{Binding CMD}" />
                                        <Setter Property="SelectedItem" Value="{Binding CMD}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.CMDList}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="IsDropDownOpen" Value="True" />
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="200"
                                CanUserSort="False"
                                CellStyle="{StaticResource VTMDataGridCellCondition1}"
                                ClipboardContentBinding="{Binding Condition1}"
                                Header="Condition1">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding Condition1}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding CommandDescriptions.Condition1}" Value="RX DATA NAME">
                                                <Setter Property="ToolTip">
                                                    <Setter.Value>
                                                        <ToolTip HorizontalContentAlignment="Left" ToolTipService.ShowDuration="60000">
                                                            <TextBlock
                                                                HorizontalAlignment="Center"
                                                                Text="{Binding Condition1Tooltip}"
                                                                TextAlignment="Left" />
                                                        </ToolTip>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Text" Value="{Binding Condition1}" />
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="SelectedItem" Value="{Binding Condition1}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.Condition1List}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="MaxDropDownHeight" Value="0" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=CommandDescriptions.IsListCondition1}" Value="true">
                                                <Setter Property="MaxDropDownHeight" Value="300" />
                                                <Setter Property="IsDropDownOpen" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="100"
                                CanUserSort="False"
                                CellStyle="{StaticResource VTMDataGridCellOper}"
                                ClipboardContentBinding="{Binding Oper}"
                                Header="Oper">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding Oper}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Text" Value="{Binding Oper}" />
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="SelectedItem" Value="{Binding Oper}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.OperList}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="MaxDropDownHeight" Value="0" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=CommandDescriptions.IsListOper}" Value="true">
                                                <Setter Property="MaxDropDownHeight" Value="300" />
                                                <Setter Property="IsDropDownOpen" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="120"
                                CanUserSort="False"
                                CellStyle="{StaticResource VTMDataGridCellCondition2}"
                                ClipboardContentBinding="{Binding Condition2}"
                                Header="Condition2">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding Condition2}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Text" Value="{Binding Condition2}" />
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="SelectedItem" Value="{Binding Condition2}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.Condition2List}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="MaxDropDownHeight" Value="0" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=CommandDescriptions.IsListCondition2}" Value="true">
                                                <Setter Property="MaxDropDownHeight" Value="300" />
                                                <Setter Property="IsDropDownOpen" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="100"
                                CanUserSort="False"
                                CellStyle="{StaticResource VTMDataGridCellSpec}"
                                ClipboardContentBinding="{Binding Spect}"
                                Header="Spect">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding Spect}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Text" Value="{Binding Spect}" />
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="SelectedItem" Value="{Binding Spect}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.SpectList}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="MaxDropDownHeight" Value="0" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=CommandDescriptions.IsListSpect}" Value="true">
                                                <Setter Property="MaxDropDownHeight" Value="300" />
                                                <Setter Property="IsDropDownOpen" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="100"
                                CanUserSort="False"
                                CellStyle="{StaticResource VTMDataGridCellMin}"
                                ClipboardContentBinding="{Binding Min}"
                                Header="Min">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding Min}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Text" Value="{Binding Min}" />
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="SelectedItem" Value="{Binding Min}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.MinList}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="MaxDropDownHeight" Value="0" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=CommandDescriptions.IsListMin}" Value="true">
                                                <Setter Property="MaxDropDownHeight" Value="300" />
                                                <Setter Property="IsDropDownOpen" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="100"
                                CanUserSort="False"
                                CellStyle="{StaticResource VTMDataGridCellMax}"
                                ClipboardContentBinding="{Binding Max}"
                                Header="Max">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding Max}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Text" Value="{Binding Max}" />
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="SelectedItem" Value="{Binding Max}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.MaxList}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="MaxDropDownHeight" Value="0" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=CommandDescriptions.IsListMax}" Value="true">
                                                <Setter Property="MaxDropDownHeight" Value="300" />
                                                <Setter Property="IsDropDownOpen" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridComboBoxColumn
                                Width="100"
                                CanUserSort="False"
                                CellStyle="{StaticResource VTMDataGridCellMode}"
                                ClipboardContentBinding="{Binding Mode}"
                                Header="Mode">
                                <DataGridComboBoxColumn.ElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <TextBlock Text="{Binding Mode}" />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridComboBoxColumn.ElementStyle>
                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Text" Value="{Binding Mode}" />
                                        <Setter Property="Background" Value="Black" />
                                        <Setter Property="IsEditable" Value="True" />
                                        <Setter Property="SelectedItem" Value="{Binding Mode}" />
                                        <Setter Property="ItemsSource" Value="{Binding Path=CommandDescriptions.ModeList}" />
                                        <Setter Property="IsTextSearchEnabled" Value="true" />
                                        <Setter Property="MaxDropDownHeight" Value="0" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=CommandDescriptions.IsListMode}" Value="true">
                                                <Setter Property="MaxDropDownHeight" Value="300" />
                                                <Setter Property="IsDropDownOpen" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>
                            </DataGridComboBoxColumn>

                            <DataGridTextColumn
                                Width="80"
                                Binding="{Binding Count}"
                                CellStyle="{StaticResource VTMDataGridCellCount}"
                                Header="Count" />

                            <DataGridTextColumn
                                Width="70"
                                Binding="{Binding E_Jump}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="E-Jump" />

                            <DataGridTextColumn
                                Width="*"
                                Binding="{Binding Remark}"
                                CanUserSort="False"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Remark">
                                <DataGridTextColumn.EditingElementStyle>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Text" Value="{Binding Remark}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding CommandDescriptions.IsListRemark}" Value="true">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate>
                                                            <ComboBox
                                                                Background="{x:Null}"
                                                                IsDropDownOpen="True"
                                                                IsEditable="True"
                                                                IsTextSearchEnabled="True"
                                                                ItemsSource="{Binding Path=CommandDescriptions.RemarkList}"
                                                                SelectedItem="{Binding Remark}"
                                                                Text="{Binding Remark}" />
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.EditingElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn
                                Width="50"
                                Binding="{Binding ELoc}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="E-Loc" />

                            <DataGridCheckBoxColumn
                                Width="50"
                                Binding="{Binding Skip, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                Header="Skip">
                                <DataGridCheckBoxColumn.CellStyle>
                                    <Style BasedOn="{StaticResource FlatVTMCell}" TargetType="DataGridCell">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type DataGridCell}">
                                                    <Grid Background="{TemplateBinding Background}">
                                                        <ContentPresenter VerticalAlignment="Center" />
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#3261AF" />
                                                <Setter Property="Foreground" Value="White" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridCheckBoxColumn.CellStyle>
                            </DataGridCheckBoxColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Label
                        Grid.Row="1"
                        VerticalAlignment="Center"
                        Content="Press 'F1' for help"
                        FontWeight="DemiBold"
                        Foreground="Black" />
                    <DataGrid
                        x:Name="TestStepsGridRemark"
                        Grid.Row="2"
                        Height="60"
                        Margin="5,5,10,5"
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        ColumnHeaderStyle="{StaticResource FlatDataGridHeaderConstance}"
                        HeadersVisibility="Column"
                        HorizontalScrollBarVisibility="Disabled"
                        IsReadOnly="True"
                        SelectionMode="Single"
                        SelectionUnit="Cell"
                        Style="{StaticResource FlatDataGrid}"
                        VerticalScrollBarVisibility="Disabled">
                        <DataGrid.Columns>

                            <DataGridTextColumn
                                Width="60"
                                Binding="{Binding No}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="No" />
                            <DataGridTextColumn
                                Width="70"
                                Binding="{Binding IMQSCode}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="QR Code" />

                            <DataGridTextColumn
                                Width="200"
                                Binding="{Binding TestContent}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Test Content" />
                            <DataGridTextColumn
                                Width="60"
                                Binding="{Binding CMD}"
                                CellStyle="{StaticResource FlatVTMCellCMD}"
                                Header="CMD" />
                            <DataGridTextColumn
                                Width="200"
                                Binding="{Binding Condition1}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Condition 1" />
                            <DataGridTextColumn
                                Width="100"
                                Binding="{Binding Oper}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Oper" />
                            <DataGridTextColumn
                                Width="120"
                                Binding="{Binding Condition2}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Condition 2" />
                            <DataGridTextColumn
                                Width="100"
                                Binding="{Binding Spect}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Spect" />
                            <DataGridTextColumn
                                Width="100"
                                Binding="{Binding Min}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Min" />
                            <DataGridTextColumn
                                Width="100"
                                Binding="{Binding Max}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Max" />
                            <DataGridTextColumn
                                Width="100"
                                Binding="{Binding Mode}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Mode" />
                            <DataGridTextColumn
                                Width="80"
                                Binding="{Binding Count}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Count" />
                            <DataGridTextColumn
                                Width="70"
                                Binding="{Binding EJump}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="E-Jump" />
                            <DataGridTextColumn
                                Width="*"
                                Binding="{Binding Remark}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Remark" />
                            <DataGridTextColumn
                                Width="50"
                                Binding="{Binding ELoc}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="E-Loc" />

                            <DataGridTextColumn
                                Width="50"
                                Binding="{Binding Skip}"
                                CellStyle="{StaticResource FlatVTMCell}"
                                Header="Skip" />
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border
                        Grid.Row="3"
                        Grid.Column="0"
                        Margin="5"
                        VerticalAlignment="Top"
                        Background="#f6f6f6"
                        CornerRadius="10">
                        <Grid Margin="3,3,3,3">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="1*" />
                            </Grid.RowDefinitions>
                            <Label
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                Content="Descriptions"
                                FontSize="12"
                                FontWeight="Bold"
                                Foreground="Black" />
                            <Label
                                x:Name="lbStepHelp"
                                Grid.Row="1"
                                Margin="5,5"
                                Foreground="Black" />
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
            <!--  Tap contructions  -->
            <TabItem
                BorderThickness="0"
                FontWeight="DemiBold"
                Foreground="Black"
                Header="Constructions"
                Style="{StaticResource FlatTabControl}">
                <Grid
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="21*" />
                        <ColumnDefinition Width="176*" />
                    </Grid.ColumnDefinitions>
                    <TabControl
                        Grid.ColumnSpan="2"
                        Margin="5,5,5,5"
                        VerticalContentAlignment="Center"
                        Background="#003a71"
                        BorderThickness="0"
                        TabStripPlacement="Left">
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="PCB Layout"
                            Style="{StaticResource FlatTabControlLeft}">
                            <ctr:PBALayoutWiewer x:Name="LayoutWiewer" VerticalAlignment="Top" />
                        </TabItem>
                        <!--<TabItem  Header="Error Positions" Foreground="White" Style="{StaticResource FlatTabControlLeft}" Width="200" Height="40"  Margin="0">
                        </TabItem>-->
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="Barcode options"
                            Style="{StaticResource FlatTabControlLeft}">
                            <ctr:ModelBarcodeOption
                                x:Name="BarcodeOptionsWiewer"
                                Width="765"
                                Height="285"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top" />
                        </TabItem>
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="Discharge"
                            Style="{StaticResource FlatTabControlLeft}">
                            <ctr:DisChargeOption
                                x:Name="DischargeOptionsWiewer"
                                Width="600"
                                Height="500"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top" />
                        </TabItem>
                        <!--<TabItem  Header="Power" Foreground="White" Style="{StaticResource FlatTabControlLeft}" Width="200" Height="40"  Margin="0">
                        </TabItem>
                        <TabItem  Header="Motor B\D" Foreground="White" Style="{StaticResource FlatTabControlLeft}" Width="200" Height="40"  Margin="0">
                        </TabItem>-->
                    </TabControl>
                </Grid>
            </TabItem>
            <!--  Tap Channels  -->
            <TabItem
                BorderThickness="0"
                FontWeight="DemiBold"
                Foreground="Black"
                Header="Channels"
                Style="{StaticResource FlatTabControl}">
                <Grid
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch">
                    <TabControl
                        Margin="5,5,5,5"
                        VerticalContentAlignment="Center"
                        Background="#003a71"
                        BorderThickness="0"
                        TabStripPlacement="Left">
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="MUX channels"
                            Style="{StaticResource FlatTabControlLeft}">
                            <ctr:MuxCardOption x:Name="MuxCardViewer" />
                        </TabItem>
                        <!--<TabItem  Header="Relay channels" Foreground="White" Style="{StaticResource FlatTabControlLeft}" Width="200" Height="40"  Margin="0">
                        </TabItem>-->
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="Level channes"
                            Style="{StaticResource FlatTabControlLeft}">
                            <ctr:LevelCardOption x:Name="LevelCardViewer" Loaded="LevelCardViewer_Loaded" />
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <!--  Tap UUTs  -->
            <TabItem
                BorderThickness="0"
                FontWeight="DemiBold"
                Foreground="Black"
                Header="UUT Port"
                Style="{StaticResource FlatTabControl}">
                <Grid
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch">
                    <TabControl
                        Margin="5,5,5,5"
                        VerticalContentAlignment="Center"
                        Background="#003a71"
                        BorderThickness="0"
                        TabStripPlacement="Left">
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="UUTs Port config"
                            Style="{StaticResource FlatTabControlLeft}">
                            <StackPanel x:Name="UUT_config_panel" Orientation="Horizontal">
                                <Border
                                    Margin="15"
                                    Background="#11ffffff"
                                    CornerRadius="0">
                                    <Grid>
                                        <Label
                                            HorizontalAlignment="Center"
                                            Content="Port P1 config"
                                            Foreground="White" />
                                        <ctr:UUTPortConfig x:Name="P1_Config_Holder" Margin="0,20,0,0" />
                                    </Grid>
                                </Border>
                                <Border
                                    Margin="15"
                                    Background="#11ffffff"
                                    CornerRadius="5">
                                    <Grid>
                                        <Label
                                            HorizontalAlignment="Center"
                                            Content="Port P2 config"
                                            Foreground="White" />
                                        <ctr:UUTPortConfig x:Name="P2_Config_Holder" Margin="0,20,0,0" />
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </TabItem>
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="TX data naming"
                            Style="{StaticResource FlatTabControlLeft}">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="60" />
                                </Grid.RowDefinitions>
                                <DataGrid
                                    x:Name="dgTX_data_naming"
                                    Width="800"
                                    HorizontalAlignment="Left"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    CanUserSortColumns="False"
                                    ClipboardCopyMode="IncludeHeader"
                                    ColumnHeaderStyle="{StaticResource FlatDataGridHeaderNomal}"
                                    GridLinesVisibility="All"
                                    IsReadOnly="False"
                                    RowHeight="18"
                                    SelectionMode="Extended"
                                    SelectionUnit="Cell"
                                    Style="{StaticResource FlatDataGrid}">

                                    <DataGrid.Columns>

                                        <DataGridTextColumn
                                            Width="300"
                                            Binding="{Binding Name}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Name" />

                                        <DataGridTextColumn
                                            Width="1.2*"
                                            Binding="{Binding Data}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Data (Hex)" />

                                        <DataGridTextColumn
                                            Width="0.5*"
                                            Binding="{Binding Blank}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Blank (Hex)" />

                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Remark}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Remark" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel Grid.Row="1" Orientation="Horizontal">

                                    <Button
                                        x:Name="btOpenTxData"
                                        Grid.Row="1"
                                        Width="180"
                                        Height="30"
                                        Margin="0,5,0,5"
                                        Padding="5"
                                        HorizontalAlignment="Left"
                                        HorizontalContentAlignment="Center"
                                        Background="{x:Null}"
                                        BorderThickness="0"
                                        Click="btOpenTxNaming_Click"
                                        FontSize="14"
                                        Foreground="#FF109322"
                                        Template="{DynamicResource ButtonControlNonHoverEffect}">

                                        <Grid Margin="0" HorizontalAlignment="Left">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="1*" />
                                            </Grid.ColumnDefinitions>
                                            <fa:IconImage
                                                Margin="2"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Foreground="#ffa000"
                                                Icon="FolderOpen" />

                                            <Label
                                                Grid.Column="1"
                                                Margin="5,0,0,0"
                                                Padding="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Content="Open Tx Naming"
                                                FontSize="12"
                                                FontStretch="UltraExpanded"
                                                FontWeight="Bold"
                                                Foreground="WhiteSmoke" />
                                        </Grid>
                                    </Button>
                                    <Button
                                        x:Name="btSaveTxData"
                                        Grid.Row="1"
                                        Width="180"
                                        Height="30"
                                        Margin="0,5,0,5"
                                        Padding="5"
                                        HorizontalAlignment="Left"
                                        HorizontalContentAlignment="Center"
                                        Background="{x:Null}"
                                        BorderThickness="0"
                                        Click="btSaveTxNaming_Click"
                                        FontSize="14"
                                        Foreground="#FF109322"
                                        Template="{DynamicResource ButtonControlNonHoverEffect}">

                                        <Grid Margin="0" HorizontalAlignment="Left">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="1*" />
                                            </Grid.ColumnDefinitions>
                                            <fa:IconImage
                                                Margin="2"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Foreground="#ffa000"
                                                Icon="Save" />

                                            <Label
                                                Grid.Column="1"
                                                Margin="5,0,0,0"
                                                Padding="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Content="Save"
                                                FontSize="12"
                                                FontStretch="UltraExpanded"
                                                FontWeight="Bold"
                                                Foreground="WhiteSmoke" />
                                        </Grid>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Header="Rx data naming"
                            Style="{StaticResource FlatTabControlLeft}">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="60" />
                                </Grid.RowDefinitions>
                                <DataGrid
                                    x:Name="dgRX_data_naming"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    CanUserSortColumns="False"
                                    ClipboardCopyMode="IncludeHeader"
                                    ColumnHeaderStyle="{StaticResource FlatDataGridHeaderNomal}"
                                    GridLinesVisibility="All"
                                    IsReadOnly="False"
                                    RowHeight="18"
                                    SelectionMode="Extended"
                                    SelectionUnit="Cell"
                                    Style="{StaticResource FlatDataGrid}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn
                                            Width="300"
                                            Binding="{Binding Path=Name}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Name" />

                                        <DataGridTextColumn
                                            Width="80"
                                            Binding="{Binding Path=ModeLoc}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Mode Loc" />
                                        <DataGridTextColumn
                                            Width="80"
                                            Binding="{Binding Path=Mode}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Mode (Hex)" />

                                        <DataGridComboBoxColumn
                                            Width="100"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Data Kind"
                                            ItemsSource="{Binding Source={StaticResource rxDataKindEnum}}"
                                            SelectedItemBinding="{Binding Path=dataKind}" />

                                        <DataGridTextColumn
                                            Width="80"
                                            Binding="{Binding Path=MByte}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="M Byte" />

                                        <DataGridTextColumn
                                            Width="80"
                                            Binding="{Binding Path=M_Mbit}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="M bit" />

                                        <DataGridTextColumn
                                            Width="80"
                                            Binding="{Binding Path=M_Lbit}"
                                            Header="L bit">
                                            <DataGridTextColumn.CellStyle>
                                                <Style BasedOn="{StaticResource FlatDataGridCell}" TargetType="DataGridCell">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="0">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="2">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <DataGridTextColumn
                                            Width="70"
                                            Binding="{Binding Path=LByte}"
                                            Header="L Byte">
                                            <DataGridTextColumn.CellStyle>
                                                <Style BasedOn="{StaticResource FlatDataGridCell}" TargetType="DataGridCell">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="0">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="1">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <DataGridTextColumn
                                            Width="80"
                                            Binding="{Binding Path=L_Mbit}"
                                            Header="M bit">
                                            <DataGridTextColumn.CellStyle>
                                                <Style BasedOn="{StaticResource FlatDataGridCell}" TargetType="DataGridCell">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="0">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="1">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="2">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <DataGridTextColumn
                                            Width="80"
                                            Binding="{Binding Path=L_Lbit}"
                                            Header="L bit">
                                            <DataGridTextColumn.CellStyle>
                                                <Style BasedOn="{StaticResource FlatDataGridCell}" TargetType="DataGridCell">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="0">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=dataKind}" Value="1">
                                                            <Setter Property="Background" Value="Gray" />
                                                            <Setter Property="Foreground" Value="Black" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <DataGridComboBoxColumn
                                            Width="100"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Type"
                                            ItemsSource="{Binding Source={StaticResource rxDataTypeEnum}}"
                                            SelectedItemBinding="{Binding Path=dataType}" />

                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Path=Remark}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Remark" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel Grid.Row="1" Orientation="Horizontal">

                                    <Button
                                        x:Name="btOpenRxData"
                                        Grid.Row="1"
                                        Width="180"
                                        Height="30"
                                        Margin="0,5,0,5"
                                        Padding="5"
                                        HorizontalAlignment="Left"
                                        HorizontalContentAlignment="Center"
                                        Background="{x:Null}"
                                        BorderThickness="0"
                                        Click="btOpenRxNaming_Click"
                                        FontSize="14"
                                        Foreground="#FF109322"
                                        Template="{DynamicResource ButtonControlNonHoverEffect}">

                                        <Grid Margin="0" HorizontalAlignment="Left">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="1*" />
                                            </Grid.ColumnDefinitions>
                                            <fa:IconImage
                                                Margin="2"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Foreground="#ffa000"
                                                Icon="FolderOpen" />

                                            <Label
                                                Grid.Column="1"
                                                Margin="5,0,0,0"
                                                Padding="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Content="Open Rx Naming"
                                                FontSize="12"
                                                FontStretch="UltraExpanded"
                                                FontWeight="Bold"
                                                Foreground="WhiteSmoke" />
                                        </Grid>
                                    </Button>
                                    <Button
                                        x:Name="btSaveRxData"
                                        Grid.Row="1"
                                        Width="180"
                                        Height="30"
                                        Margin="0,5,0,5"
                                        Padding="5"
                                        HorizontalAlignment="Left"
                                        HorizontalContentAlignment="Center"
                                        Background="{x:Null}"
                                        BorderThickness="0"
                                        Click="btSaveRxNaming_Click"
                                        FontSize="14"
                                        Foreground="#FF109322"
                                        Template="{DynamicResource ButtonControlNonHoverEffect}">

                                        <Grid Margin="0" HorizontalAlignment="Left">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="1*" />
                                            </Grid.ColumnDefinitions>
                                            <fa:IconImage
                                                Margin="2"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Foreground="#ffa000"
                                                Icon="Save" />

                                            <Label
                                                Grid.Column="1"
                                                Margin="5,0,0,0"
                                                Padding="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Content="Save Rx Naming  "
                                                FontSize="12"
                                                FontStretch="UltraExpanded"
                                                FontWeight="Bold"
                                                Foreground="WhiteSmoke" />
                                        </Grid>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <!--  Tap QR Code  -->
            <TabItem
                BorderThickness="0"
                FontWeight="DemiBold"
                Foreground="Black"
                Header="QR Code"
                Style="{StaticResource FlatTabControl}">
                <Grid
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch">
                    <TabControl
                        Margin="5,5,5,5"
                        VerticalContentAlignment="Center"
                        Background="#003a71"
                        BorderThickness="0"
                        TabStripPlacement="Left">
                        <TabItem
                            Width="200"
                            Height="40"
                            Margin="0"
                            Foreground="White"
                            Header="QR Data naming"
                            Style="{StaticResource FlatTabControlLeft}">

                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="60" />
                                </Grid.RowDefinitions>
                                <DataGrid
                                    x:Name="dgQRcodeNameCode"
                                    Width="500"
                                    Margin="5"
                                    HorizontalAlignment="Left"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="True"
                                    CanUserSortColumns="False"
                                    ClipboardCopyMode="IncludeHeader"
                                    ColumnHeaderStyle="{StaticResource FlatDataGridHeaderNomal}"
                                    HeadersVisibility="Column"
                                    IsReadOnly="False"
                                    RowHeight="17"
                                    SelectionMode="Extended"
                                    SelectionUnit="Cell"
                                    Style="{StaticResource FlatDataGrid}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn
                                            Width="40"
                                            Binding="{Binding Path=No}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="No" />

                                        <DataGridTextColumn
                                            Width="1*"
                                            Binding="{Binding Path=Context}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Contents" />

                                        <DataGridTextColumn
                                            Width="0.5*"
                                            Binding="{Binding Path=Code}"
                                            CellStyle="{StaticResource FlatDataGridCell}"
                                            Header="Code" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel Grid.Row="1" Orientation="Horizontal">

                                    <Button
                                        x:Name="btOpenQrData"
                                        Grid.Row="1"
                                        Width="180"
                                        Height="30"
                                        Margin="0,5,0,5"
                                        Padding="5"
                                        HorizontalAlignment="Left"
                                        HorizontalContentAlignment="Center"
                                        Background="{x:Null}"
                                        BorderThickness="0"
                                        Click="btOpenQrNaming_Click"
                                        FontSize="14"
                                        Foreground="#FF109322"
                                        Template="{DynamicResource ButtonControlNonHoverEffect}">

                                        <Grid Margin="0" HorizontalAlignment="Left">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="1*" />
                                            </Grid.ColumnDefinitions>
                                            <fa:IconImage
                                                Margin="2"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Foreground="#ffa000"
                                                Icon="FolderOpen" />

                                            <Label
                                                Grid.Column="1"
                                                Margin="5,0,0,0"
                                                Padding="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Content="Open QR Naming"
                                                FontSize="12"
                                                FontStretch="UltraExpanded"
                                                FontWeight="Bold"
                                                Foreground="WhiteSmoke" />
                                        </Grid>
                                    </Button>
                                    <Button
                                        x:Name="btSaveQrData"
                                        Grid.Row="1"
                                        Width="180"
                                        Height="30"
                                        Margin="0,5,0,5"
                                        Padding="5"
                                        HorizontalAlignment="Left"
                                        HorizontalContentAlignment="Center"
                                        Background="{x:Null}"
                                        BorderThickness="0"
                                        Click="btSaveQrNaming_Click"
                                        FontSize="14"
                                        Foreground="#FF109322"
                                        Template="{DynamicResource ButtonControlNonHoverEffect}">

                                        <Grid Margin="0" HorizontalAlignment="Left">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="1*" />
                                            </Grid.ColumnDefinitions>
                                            <fa:IconImage
                                                Margin="2"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Foreground="#ffa000"
                                                Icon="Save" />

                                            <Label
                                                Grid.Column="1"
                                                Margin="5,0,0,0"
                                                Padding="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Content="Save QR Naming"
                                                FontSize="12"
                                                FontStretch="UltraExpanded"
                                                FontWeight="Bold"
                                                Foreground="WhiteSmoke" />
                                        </Grid>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
        </TabControl>
        <StackPanel
            Margin="20,5"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Orientation="Horizontal">

            <Label
                x:Name="lblModel"
                Grid.Column="1"
                Margin="5,0,0,0"
                Padding="0"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Content="MODEL:"
                FontSize="20"
                FontStyle="Italic"
                FontWeight="DemiBold"
                Foreground="Black" />
            <TextBlock
                x:Name="lbModelName"
                Grid.Column="1"
                Margin="5,0,50,0"
                Padding="0"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontSize="20"
                FontStyle="Italic"
                FontWeight="DemiBold"
                Foreground="Black"
                Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />

            <Button
                x:Name="btOpenModel"
                Width="120"
                Height="30"
                Margin="0,5,0,5"
                Padding="5"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Background="{x:Null}"
                BorderThickness="0"
                Click="btOpenModel_Click"
                FontSize="14"
                Foreground="#FF109322"
                Template="{DynamicResource ButtonControlNonHoverEffect}">

                <Grid Margin="0" HorizontalAlignment="Left">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <fa:IconImage
                        Margin="2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="#ffa000"
                        Icon="FolderOpen" />

                    <Label
                        Grid.Column="1"
                        Margin="5,0,0,0"
                        Padding="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Content="Open model"
                        FontSize="12"
                        FontStretch="UltraExpanded"
                        FontWeight="Bold"
                        Foreground="Black" />
                </Grid>
            </Button>
            <Button
                x:Name="btSaveModel"
                Width="80"
                Height="30"
                Margin="0,5,0,5"
                Padding="5"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Background="{x:Null}"
                BorderThickness="0"
                Click="btSaveModel_Click"
                FontSize="14"
                Foreground="#FF109322"
                Template="{DynamicResource ButtonControlNonHoverEffect}">

                <Grid Margin="0" HorizontalAlignment="Left">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <fa:IconImage
                        Margin="2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="#ffa000"
                        Icon="Save" />

                    <Label
                        Grid.Column="1"
                        Margin="5,0,0,0"
                        Padding="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Content="Save"
                        FontSize="12"
                        FontStretch="UltraExpanded"
                        FontWeight="Bold"
                        Foreground="Black" />
                </Grid>
            </Button>
            <Button
                x:Name="btSaveAsModel"
                Width="80"
                Height="30"
                Margin="0,5,0,5"
                Padding="5"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Background="{x:Null}"
                BorderThickness="0"
                Click="btSaveAsModel_Click"
                FontSize="14"
                Foreground="#FF109322"
                Template="{DynamicResource ButtonControlNonHoverEffect}">

                <Grid Margin="0" HorizontalAlignment="Left">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <fa:IconImage
                        Margin="2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="#ffa000"
                        Icon="Save" />
                    <fa:IconImage
                        Grid.ColumnSpan="2"
                        Width="7"
                        Height="7"
                        Margin="16,0,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Foreground="#ffa000"
                        Icon="CirclePlus" />

                    <Label
                        Grid.Column="1"
                        Margin="5,0,0,0"
                        Padding="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Content="Save As"
                        FontSize="12"
                        FontStretch="UltraExpanded"
                        FontWeight="Bold"
                        Foreground="Black" />
                </Grid>
            </Button>
        </StackPanel>
        <Label
            x:Name="saveLabel"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            HorizontalContentAlignment="Center"
            VerticalContentAlignment="Center"
            Background="#AF000000"
            Content="Saved!"
            FontSize="50"
            FontWeight="Bold"
            Foreground="White"
            Visibility="Hidden" />
        <TextBlock
            x:Name="tbHelp"
            Padding="30"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Background="#DF000000"
            FontWeight="Bold"
            Foreground="White"
            Visibility="Hidden">
            <Run
                FontSize="20"
                FontWeight="DemiBold"
                Text="Shortcut model editter:" />
            <LineBreak />
            <LineBreak />
            <Run Text="         Ctr + N / '+'       Add new step" />
            <LineBreak />
            <Run Text="         Ctr + D/Insert    Copy down selected step" />
            <LineBreak />
            <Run Text="         Ctr + Delete       Delete sellect step " />
            <LineBreak />
            <Run Text="         Ctr + F1              Open shotcut helper" />
            <LineBreak />
            <Run Text="         Ctr + I                 Import from FPT program" />
            <LineBreak />
            <Run Text="         Ctr + S                Save current model " />
            <LineBreak />
            <Run Text="         Ctr + O               Open model " />
            <LineBreak />
            <Run Text="         Ctr + C                Copy current step " />
            <LineBreak />
            <Run Text="         Ctr + V                Paste copied step to this step (Insert at current step)" />
            <LineBreak />
            <Run Text="         Shift + Down      Move current step down " />
            <LineBreak />
            <Run Text="         Shift + Up           Move current step up " />
        </TextBlock>
    </Grid>
</Page>